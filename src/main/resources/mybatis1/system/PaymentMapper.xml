<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="paymentMapper">
    <insert id="reg" parameterType="com.fh.entity.system.Payment">
        INSERT INTO
        TB_APPUSER_PAYMENT
        (
        GOLD,
        USERID,
        CREATE_TIME,
        DOLLID,
        COST_TYPE,
        REMARK
        )VALUES
        (
        #{GOLD},
        #{USERID},
        now(),
        #{DOLLID},
        #{COST_TYPE},
        #{REMARK}
        )
    </insert>


	<!-- 列表 -->
	<select id="findGoldDetaillistPage" parameterType="page" resultType="pd">
		select 
			p.ID,
			p.USERID,
			p.GOLD,
			p.COST_TYPE,
			p.CREATE_TIME,
			u.CNEE_NAME 
			
			from TB_APPUSER_PAYMENT p 
						left join sys_app_user u
						on u.USER_ID=p.USERID

		where 1=1
       
        
            <if test="pd.lastStart != null and pd.lastStart != ''">
                and p.CREATE_TIME &gt;= str_to_date(#{pd.lastStart}, '%Y-%m-%d %H:%i:%s')
            </if>
            <if test="pd.lastEnd != null and pd.lastEnd != ''">
                and p.CREATE_TIME &lt;= str_to_date(#{pd.lastEnd}, '%Y-%m-%d %H:%i:%s')
            </if>
             <if test="pd.keywords!= null and pd.keywords != ''"><!-- 关键词检索 -->
            and  u.CNEE_NAME LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%')
        </if>
        <if test="pd.COST_TYPE != null and pd.COST_TYPE != ''"><!-- 状态检索 -->
            and p.COST_TYPE = #{pd.COST_TYPE}
        </if>
		
		ORDER BY P.CREATE_TIME desc
	</select>
	
	
		<!-- 列表 -->
	<select id="findRegDetaillistPage" parameterType="page" resultType="pd">
		select 
				
			   o.REC_ID,
			   o.ORDER_ID,
			   o.CREATETIME,
			   o.REGMODE,
			   o.REGAMOUNT,
			   o.`STATUS`,
			   u.CNEE_NAME
			   from sys_app_order o 
			   		left join sys_app_user u 
			   			on u.USER_ID=o.USER_ID

		where 1=1
   
        
         <if test="pd.lastStart != null and pd.lastStart != ''">
             and o.CREATETIME &gt;= str_to_date(#{pd.lastStart}, '%Y-%m-%d %H:%i:%s')
         </if>
         <if test="pd.lastEnd != null and pd.lastEnd != ''">
             and o.CREATETIME &lt;= str_to_date(#{pd.lastEnd}, '%Y-%m-%d %H:%i:%s')
         </if>
         <if test="pd.keywords!= null and pd.keywords != ''"><!-- 关键词检索 -->
            and  u.CNEE_NAME LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%')
        </if>
        <if test="pd.STATUS != null and pd.STATUS != ''"><!-- 状态检索 -->
            and o.`STATUS` = #{pd.STATUS}
        </if>
		
		ORDER BY o.CREATETIME desc
	</select>
    
    <!--查询用户的支出明细-->
    <select id="getPaymenlist" parameterType="String" resultType="com.fh.entity.system.Payment">
        select * from tb_appuser_payment where userid = #{USERID} order by create_time desc ;
    </select>
    
    
    

</mapper>